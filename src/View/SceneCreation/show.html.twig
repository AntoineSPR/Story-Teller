{% extends 'layout.html.twig' %}
{% block head_extra %}
<script src="/assets/js/editDialogue.js" defer></script>
{% endblock %}

{% block content %}

<p>Histoire :
  {{ story.name }}
</p>
<a href="/storycreation/show?id={{ story.id }}">Retour à l'histoire</a>
<h1>{{scene.name}}</h1>

<h2>Personnages :</h2>
<ul>
  {% for character in characters %}
  <li>
    <input type="checkbox" id="{{character.name}}" name="{{character.name}}">
    <label for="{{character.name}}">{{character.name}}
      <a href="/storycreation/delchar?story_id={{story.id}}&scene_id={{scene.id}}&id={{character.id}}"> supprimer</a>
      <button class="edit">Editer</button>
      <form method="post" action="/storycreation/update_char?story_id={{ story.id }}&scene_id={{ scene.id }}&id={{ character.id }}" class="character-edit">
        <input type="text" name="e_name" id="character_name">
        <input type="text" name="e_sprite" id="e_sprite">
        <input type="submit">
        <button class="cancel">&#10006;</button>
      </form>
  </li>
  {% endfor %}
  <form method='post' action="/storycreation/addchar?story_id={{ story.id }}&scene_id={{ scene.id }}">
    <label for="name"></label>
    <input type="text" id="name" name="name">
    <label for="sprite">sprite</label>
    <input type="text" id="sprite" name="sprite">
    <input type="submit">
  </form>
</ul>

<h2>Répliques :</h2>
<ul>
  {% for dialogue in dialogues %}
  <li>
    {{ dialogue.character_name }} :
    {{ dialogue.body }}
  </li>
  {% endfor %}
  <li><a href="/storycreation/scene/add_dial?story_id={{ story.id }}&scene_id={{ scene.id }}"> Ajouter une ligne de dialogue</a></li>
</ul>

<h2>Choix :</h2>
<ul>
  {% for choice in choices %}
  <li>
    {{ choice.body }}   ⇒  <a href ="/storycreation/scene/show?story_id={{ story.id }}&id={{ choice.next_scene_id }}">{{ choice.next_scene_name }}</a>
      <a href="/storycreation/delchoice?story_id={{story.id}}&scene_id={{scene.id}}&id={{choice.id}}"> supprimer</a>
      <button class="choice-edit">Editer</button>
      <form method="post" action="/storycreation/update_choice?story_id={{ story.id }}&scene_id={{ scene.id }}&id={{ choice.id }}" class="choice-edit-form">
        <input type="text" name="e_body" id="e_body">
        <select name="e_next_scene" id="e_next_scene">
          {% for onescene in allscenes %}
            <option value={{ onescene.id }}>{{ onescene.name }}</option>
          {% endfor %}
        </select>
        <input type="submit">
        <button class="cancel">&#10006;</button>
      </form>
  </li>
  {% endfor %}
  <li>
    <form method='post' 
    action="/storycreation/addchoice?story_id={{ story.id }}&scene_id={{ scene.id }}&next_scene_id={{ onescene.id }}">
      <label for="body"></label>
      <input type="text" id="body" name="body">
      <select name="next_scene" id="next_scene">
          {% for onescene in allscenes %}
            <option value={{ onescene.id }}>{{ onescene.name }}</option>
          {% endfor %}
        </select>
      <input type="submit">
      <button class="choice_cancel">&#10006;</button>
    </form>
  <li>
</ul>
{% endblock %}